<!DOCTYPE html>
<html lang="zh">
    <head>
    <!-- 
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.0 -->

    <!-- Title -->
    
    <title>
        
            玩转MongoDB之基础杂萃 | 
        
        Hummingman
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.ico">
    <link rel="icon" sizes="192x192" href="/img/favicon.ico">
    <link rel="apple-touch-icon" href="/img/favicon.ico">

    <!-- Meta & Info -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Anderson">
    <meta name="description" content="Real Developer Ship">
    <meta name="keywords" content="Hummingman,MongoDB">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Hummingman">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="玩转MongoDB之基础杂萃 | Hummingman">
    <meta property="og:description" content="Real Developer Ship">
    <meta property="og:article:tag" content="MongoDB"> 

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }
</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>



    <script src="/js/jquery.min.js"></script>
    <script src="/js/queue.js"></script>

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    

    <!-- Bing Background -->
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1、数组"><span class="post-toc-number">1.</span> <span class="post-toc-text">1、数组</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2、文档嵌套"><span class="post-toc-number">2.</span> <span class="post-toc-text">2、文档嵌套</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3、文档标识"><span class="post-toc-number">3.</span> <span class="post-toc-text">3、文档标识</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3、添加文档"><span class="post-toc-number">4.</span> <span class="post-toc-text">3、添加文档</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4、删除文档"><span class="post-toc-number">5.</span> <span class="post-toc-text">4、删除文档</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#5、更新文档"><span class="post-toc-number">6.</span> <span class="post-toc-text">5、更新文档</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#6、查询"><span class="post-toc-number">7.</span> <span class="post-toc-text">6、查询</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#7、游标"><span class="post-toc-number">8.</span> <span class="post-toc-text">7、游标</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#8、-WHERE"><span class="post-toc-number">9.</span> <span class="post-toc-text">8、$WHERE</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#9、-排序-amp-分页"><span class="post-toc-number">10.</span> <span class="post-toc-text">9、 排序&分页</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#10、索引"><span class="post-toc-number">11.</span> <span class="post-toc-text">10、索引</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#11、聚合"><span class="post-toc-number">12.</span> <span class="post-toc-text">11、聚合</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#12、归纳一下MongoDB中的一些Tips"><span class="post-toc-number">13.</span> <span class="post-toc-text">12、归纳一下MongoDB中的一些Tips</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#说明"><span class="post-toc-number">14.</span> <span class="post-toc-text">说明</span></a></li></ol>

        <!--
        <li class="mdl-menu__item">
            
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script>
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').css('background-image', 'url(' + '/img/random/material-' + randomNum + '.png' + ')');
</script>

        
    
            <p class="article-headline-p">
                玩转MongoDB之基础杂萃
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Anderson</strong>
        <span>2016年07月08日</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
            <i class="material-icons" role="presentation">crop free</i>
            <span class="visuallyhidden">devices other</span>
        </button>
        <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
            <li class="mdl-menu__item">在其它设备中阅读本文章</li>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACYElEQVR42u3aQZLbMAwEQP//08kDUnZmCJLWbrVOqrItsXkgYACvP7/6euHh4eHh4eHh4T2M94qvt4/75zvvfpU8+d1z8rXh4eHh3eH956gteZ+X+xk8XxseHh7eTd67lyX37aLnQQIPDw/vZ/HyBDoJIflW4uHh4f1cXpJet6n24+IeHh4e3qZixCSN/hww2q3Ew8PD+y4vbzLdv7/a38PDw8MLePVIU1ycbUsSR4au8PDw8A7w8oN4rUS7Vs5o14OHh4f3BF7ytz8JG3sHBaINwsPDwzvMSxLihJ08IdmIdlujYgQeHh7eAV6bHK+l1HmBeJS+4+Hh4V3h5YEhL9Qmn7ahIkrr8fDw8A7zEsykJZY3vVp2MRmBh4eHt5WXN6LaBDcvZOwND3h4eHjf4iXI/NN8RKBN5Ufjqnh4eHhLvLWD+FwwmBdz8fDw8E7z1hpgyW9bRjt2cHB0AA8PDy8u47bJcXugt/eLxRE8PDy8w7x5Q2seQpIt29YAw8PDwxvz8oXmL5uMuq6B8fDw8O7z1pLpfNFt4MmDQT1ThoeHh7eVt5ba5iXgtljcDs7i4eHhPYeXJ9a7yrWjBB0PDw/vS7wWuZYoJ7A2SODh4eGd5rXXrlR70k4bjQ7g4eHhjXlrB/GuMYI2ZY/WhoeHh3eFlwSDSbEgSc3bjRg1wPDw8PA28dpR0bUWVxtm6mIHHh4e3uN57aE/KWREb8HDw8N7JG/X4FTSTmvDEh4eHt5NXlKMWCv+zoNBsk48PDy8m7x2ofmQQbuJbYEYDw8P7z7v9114eHh4eHh4eHgPuP4Cm02bp9qf5+sAAAAASUVORK5CYII=">
        </ul>
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark_border</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/MongoDB/">MongoDB</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">more_horiz</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=玩转MongoDB之基础杂萃&url=//2016/07/08/玩转MongoDB之基础杂萃/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=玩转MongoDB之基础杂萃&url=//2016/07/08/玩转MongoDB之基础杂萃/index.html&via=Anderson" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=//2016/07/08/玩转MongoDB之基础杂萃/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=//2016/07/08/玩转MongoDB之基础杂萃/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    
        <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=//2016/07/08/玩转MongoDB之基础杂萃/index.html&title=玩转MongoDB之基础杂萃" target="_blank">
            <li class="mdl-menu__item">
                分享到 LinkedIn
            </li>
        </a>
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Hummingman&title=玩转MongoDB之基础杂萃&summary=Real Developer Ship&pics=/img/favicon.ico&url=/2016/07/08/玩转MongoDB之基础杂萃/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
        <a class="post_share-link" href="https://telegram.me/share/url?url=//2016/07/08/玩转MongoDB之基础杂萃/index.html&text=玩转MongoDB之基础杂萃" target="_blank">
            <li class="mdl-menu__item">
                分享到 Telegram
            </li>
        </a>
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>由于工作需要，最近开始接触MongoDB，对于一个已经习惯了传统SQL的程序员来说，进入NoSQL可以说是需要莫大的勇气的。最大的不适应，是NoSQL和SQL的存储原理与思维方式的不一致。当然，笔者也是NoSQL中的菜鸟，在这里分享一下自己的一些学习总结与心得。</p>
<a id="more"></a>
<h4 id="1、数组"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#1、数组" class="headerlink" title="1、数组"></a>1、数组</h4><p>在MongoDB中，文档（Document）即表示数据库中的一个集合中的一条记录，相当于关系型数据库中的行（row）。在MongoDB中，数组是使用JSON语法表示的，在MongoDB中，也称为BSON格式。数组既可以作为有序对象来操作，也可以作为无序对象来操作。有序对象比如列表等，无序对象比如集合等等。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  "a" : 0,               //这明显不是一个数组</div><div class="line">  "b" : [],              //定义一个空的数组 </div><div class="line">  "c" : [ "1","2","3"]   //包含3个元素的数组</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="2、文档嵌套"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#2、文档嵌套" class="headerlink" title="2、文档嵌套"></a>2、文档嵌套</h4><p>在NoSQL中，文档与文档之间是可以随意嵌套的，比如某个字段的值为某个类型的对象。理论上，MongoDB支持无限级的自我嵌套，比如：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"a"</span>: &#123;<span class="attr">"b"</span>:<span class="number">1</span>,<span class="attr">"c"</span>:<span class="number">2</span>&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="3、文档标识"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#3、文档标识" class="headerlink" title="3、文档标识"></a>3、文档标识</h4><p>如果标记当前这个文档，按照关系型数据库的习惯，则可以说，如果保证一条记录在数据库里是唯一的，在传统SQL中，使用主键ID来标识记录的全局唯一性，而在MongoDB中，则使用ObjectId来确保文档的唯一标识，即_id的默认类型。<br>ObjectID是一个12字节的BSON数据类型，格式如下：</p>
<ul>
<li>前四个字节表示时间戳</li>
<li>接下来三个字节是机器标识码</li>
<li>紧接的两个字节由进程ID组成，即PID</li>
<li>最后三个字节是随机数</li>
</ul>
<p>MongoDB中的每个文档必须有一个名为_id的键，可以是任意类型，默认为ObjectID类型。</p>
<p>以下是在Shell中关于ObjectId的一些方法:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">#生成一个新的ObjectId</div><div class="line">newObjectId = ObjectId()</div><div class="line"></div><div class="line">#返回的id为：ObjectId("5349b4ddd2781d08c09890f3")</div><div class="line"></div><div class="line">#获取文档</div><div class="line">ObjectId("5349b4ddd2781d08c09890f3").getTimestamp()</div><div class="line"></div><div class="line">#返回时间为：ISODate("2016-07-06T21:49:17Z")</div><div class="line"></div><div class="line">#将ObjectId转化为字符串</div><div class="line">new ObjectId().str</div><div class="line"></div><div class="line">#返回结果为：5349b4ddd2781d08c09890f3</div></pre></td></tr></table></figure>
<h4 id="3、添加文档"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#3、添加文档" class="headerlink" title="3、添加文档"></a>3、添加文档</h4><p>插入文档使用db.col.insert(document)。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">db.Collection_Name.insert(&#123;</div><div class="line">  <span class="string">"name"</span>:<span class="string">"demo"</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ol>
<li>如果文档不包含_id键，MongoDB会自动创建一个ObjectId类型的_id值</li>
<li>默认情况下插入操作时，MongoDB只检查传入数据是否包含_id以及数据大小是否超过16MB，所以可以得到更高的性能插入，但同时也可能录入无效数据。</li>
<li>因为在插入时是不执行任何代码的，所以与传统SQL相比，MongoDB不存在SQL注入风险。</li>
</ol>
<h4 id="4、删除文档"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#4、删除文档" class="headerlink" title="4、删除文档"></a>4、删除文档</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">db.Collection_Name.remove();   <span class="comment">//清空集合内的所有文档</span></div><div class="line">db.Collection_Name.remove(    <span class="comment">//清空指定文档</span></div><div class="line">  &#123;</div><div class="line">     <span class="string">"a"</span>：<span class="string">"a"</span></div><div class="line">  &#125;</div><div class="line">);</div></pre></td></tr></table></figure>
<p>当集合内数据过多时，可以考虑下面这个方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">db.drop_collection(Collection_Name);  <span class="comment">//直接删除集合</span></div><div class="line">db.Collection_Name.ensureIndex();      <span class="comment">//重建索引</span></div></pre></td></tr></table></figure>
<h4 id="5、更新文档"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#5、更新文档" class="headerlink" title="5、更新文档"></a>5、更新文档</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//update语法定义</span></div><div class="line">db.Collection_Name.update(query,<span class="built_in">document</span>,upsert,multi);</div><div class="line"></div><div class="line"><span class="comment">//设定原文档为：</span></div><div class="line"><span class="keyword">var</span> data = &#123;<span class="attr">_id</span>:<span class="string">"xxxx"</span>,<span class="string">"a"</span>:<span class="number">1</span>,<span class="string">"b"</span>:<span class="number">2</span>&#125;;</div><div class="line"></div><div class="line"><span class="comment">//query 是指查询条件，相当于SQL中的where子句，比如:</span></div><div class="line">db.Collection_Name.update(</div><div class="line">  &#123;<span class="attr">_id</span>:<span class="string">"xxxx"</span>,<span class="string">"a"</span>:<span class="number">1</span>,<span class="string">"b"</span>:<span class="number">2</span>&#125;,       <span class="comment">//定位条件，对符合_id=xxxx，a=1，b=2的文档进行更新</span></div><div class="line">  &#123;<span class="string">"a"</span>:<span class="number">2</span>&#125;,                        <span class="comment">//将a的值改为2，替换整个文档</span></div><div class="line">  <span class="literal">true</span>,                           <span class="comment">//若查询不到符合条件的文档，则新增一个文档</span></div><div class="line">  <span class="literal">true</span>                            <span class="comment">//允许更新多行</span></div><div class="line">);</div></pre></td></tr></table></figure>
<ul>
<li>update操作会替换整个匹配的文档。而不是进行某些特定字段的修改。如果需要更新某个特定字段值，则应当使用修改器。</li>
<li>upsert模式是一个布尔值选项，表示是否文档更新时，如果不存在，能够自动创建。</li>
<li>multi模式也是一个布尔值选项，默认情况下只更新匹配到的第一个文档，开启了multi模式后(即设置为true),则会更新所有匹配的文档。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//更新文档使用到的一些修改器，由$符号定义</span></div><div class="line"><span class="comment">//$inc 增加或减少数字的值，键不存在时自动创建</span></div><div class="line">db.Collection_Name.update(</div><div class="line">  &#123;<span class="string">"name"</span> : <span class="string">"翘着二郎腿打代码"</span>&#125;,</div><div class="line">  &#123;<span class="string">"$inc"</span> : &#123; <span class="string">"lover"</span> : <span class="number">1</span> &#125;&#125;               <span class="comment">//只将lover字段的值加1</span></div><div class="line">);</div><div class="line"></div><div class="line"><span class="comment">//$set 设置某一项或者多个项目的值</span></div><div class="line">db.Collection_Name.update(</div><div class="line">  &#123;<span class="string">"name"</span> ： <span class="string">"翘着二郎腿打代码"</span>&#125;,</div><div class="line">  &#123;<span class="string">"$set"</span> : &#123;<span class="string">"name"</span> : <span class="string">"打代码"</span> &#125;&#125;</div><div class="line">);</div><div class="line">这里列举一些常用的修改器</div><div class="line">$inc      设置自增或者自减</div><div class="line">$set      设置指定键的值</div><div class="line">$unset    $set的反操作，会删除键及键值</div><div class="line">$push     将元素追加到数组末尾，数组不存在则自动创建</div><div class="line">$pushAll  $push的批量操作版本</div><div class="line">$addToSet 与$push一样，会自动过滤重复元素</div><div class="line">$pop      从数组中移除元素,<span class="number">1</span>代表从末尾移除，<span class="number">-1</span>代码从开头移除</div><div class="line">$pull     从数组中移除所有匹配的元素</div><div class="line">$pullAll  $pull的批量操作版本</div><div class="line">$rename   修改制定键的键名</div><div class="line">$bit      对整型键进行位操作</div><div class="line">另外，还有一种方式可以实现文档的更新：</div><div class="line"><span class="comment">//使用findAndModify()更新文档</span></div><div class="line">db.Collection_Name.findAndModify(</div><div class="line">  &#123;</div><div class="line">      <span class="string">'query'</span> : &#123;<span class="string">"name"</span> : <span class="string">"翘着二郎腿打代码"</span> &#125;,</div><div class="line">      <span class="string">'update'</span> : &#123;<span class="string">"$set"</span> : &#123; <span class="string">"favour"</span> : <span class="number">100</span> &#125; &#125;,</div><div class="line">      <span class="string">'new'</span> : <span class="literal">true</span></div><div class="line">  &#125;</div><div class="line">);</div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">其中的参数如下：</div><div class="line"></div><div class="line">query   :  查询条件，用来定位到匹配的文档</div><div class="line">sort    :  如果匹配到多个文档，指定一个排序方式，-1降序，1升序</div><div class="line">remove  :  是否删除匹配的文档</div><div class="line">new     :  是否返回更新后的文档</div><div class="line">update  :  更新操作</div><div class="line">upsert  :  是否自动创建，如果匹配不到文档</div><div class="line"></div><div class="line">**/</div><div class="line">save()</div><div class="line"><span class="comment">//文档不存在时，执行insert操作，存在是执行update操作。</span></div><div class="line">db.demo.save(<span class="built_in">document</span>);</div></pre></td></tr></table></figure>
<h4 id="6、查询"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#6、查询" class="headerlink" title="6、查询"></a>6、查询</h4><p>我们先来举一些简单的例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//select * from demo;</span></div><div class="line">db.demo.find();</div><div class="line"></div><div class="line"><span class="comment">//select * from demo where a = 1;</span></div><div class="line">db.demo.find(&#123;<span class="string">"a"</span>:<span class="number">1</span>&#125;);</div><div class="line"></div><div class="line"><span class="comment">//select a,b from demo where a = 1;</span></div><div class="line">db.demo.find(&#123;<span class="string">"a"</span>:<span class="number">1</span>&#125;,&#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">1</span>&#125;);</div><div class="line"></div><div class="line"><span class="comment">//select * from demo where a = 1 order by name asc;</span></div><div class="line">db.demo.find(&#123;<span class="string">"a"</span>:<span class="number">1</span>&#125;).sort(&#123;<span class="string">"name"</span>:<span class="number">1</span>&#125;);</div><div class="line"></div><div class="line"><span class="comment">//select * from demo where a &gt; 1;</span></div><div class="line">db.demo.find(&#123;<span class="string">"a"</span>:&#123;<span class="attr">$gt</span>:<span class="number">1</span>&#125;&#125;);</div><div class="line"></div><div class="line"><span class="comment">//select * from demo where a like 'eee';</span></div><div class="line">db.demo.find(&#123;<span class="string">"name"</span>:<span class="string">"/^eee/"</span>&#125;);</div><div class="line"></div><div class="line"><span class="comment">//select * from demo limit 10 skip 20;</span></div><div class="line">db.demo.find().limit(<span class="number">10</span>).skip(<span class="number">20</span>);</div></pre></td></tr></table></figure>
<p>当然还有很多其他的语法形式，这里不再一一列举。下面列举一些常见的查询条件操作符</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">$lt    #小于</div><div class="line">$lte   #小于等于</div><div class="line">$gt    #大于</div><div class="line">$gte   #大于等于</div><div class="line">$all   #完全匹配</div><div class="line">$mod   #取模</div><div class="line">$ne    #不等于</div><div class="line">$in    #在...内</div><div class="line">$nin   #不在...内</div><div class="line">$nor   #既不...也不...</div><div class="line">$or    #或</div><div class="line">$size  #匹配数组长度</div><div class="line">$type  #匹配数据类型</div><div class="line">slice()函数用于数组的查询</div><div class="line">db.demo.find(&#123;&#125;,&#123;favours:&#123;'$slice':1&#125;&#125;);     //仅返回数组中的前1项</div><div class="line">db.demo.find(&#123;&#125;,&#123;favours:&#123;'$slice':-1&#125;&#125;);    //仅返回数组中的最后一项</div><div class="line">db.demo.find(&#123;&#125;,&#123;favours:&#123;'$slice':[1,2]&#125;&#125;); //跳过前1项，返回接下来的10项</div><div class="line">db.demo.find(&#123;&#125;,&#123;favours:&#123;'$slice':[-1,1]&#125;&#125;);//跳过最后一项，返回接下来的1项</div></pre></td></tr></table></figure>
<h4 id="7、游标"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#7、游标" class="headerlink" title="7、游标"></a>7、游标</h4><p>MongoDB中的游标已经在各个版本的驱动程序中封装好了，不需要像传统SQL那样使用PL/SQL结构化编程来声明游标，在Shell中，游标的使用方式与Java中的迭代器十分相似。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> cursor = db.demo.find();  <span class="comment">//声明游标</span></div><div class="line"><span class="keyword">while</span>(cursor.hasNext())&#123;      <span class="comment">//遍历集合</span></div><div class="line">  <span class="keyword">var</span> element = cursor.next();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="8、-WHERE"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#8、-WHERE" class="headerlink" title="8、$WHERE"></a>8、$WHERE</h4><p>$where操作符也是用来定位查询的，这个SQL中的where非常类似，前面我们说过，匹配文档的时候可以使用各种查询条件操作符来实现，但是为什么还要有这个操作符呢？因为有些查询是无法通过之前讲过 的那些查询操作符来实现的。值得注意的是，$where操作符的性能低，没有使用也无法使用索引机制。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">//传统SQL</div><div class="line">select * from demo where a &gt; 1;</div><div class="line"></div><div class="line">//使用查询操作符实现</div><div class="line">db.demo.find(&#123;a:&#123;"$gt":1&#125;&#125;);</div><div class="line"></div><div class="line">//使用$where实现</div><div class="line">db.demo.find(&#123;"$where":"this.a &gt; 1"&#125;);</div><div class="line">db.demo.find("this.a &gt; 1");</div><div class="line">db.demo.find(function()&#123;</div><div class="line">  return this.a &gt; 1;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="9、-排序-amp-分页"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#9、-排序-amp-分页" class="headerlink" title="9、 排序&amp;分页"></a>9、 排序&amp;分页</h4><p>MongoDB中提供了相关的方法进行排序和分页，主要有limit(),skip()和sort()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//每页10条记录，略过前面10条记录，按a降序排序</span></div><div class="line">db.demo.find().limit(<span class="number">10</span>).skip(<span class="number">10</span>).sort(&#123;<span class="attr">a</span>:<span class="number">-1</span>&#125;);</div></pre></td></tr></table></figure>
<h4 id="10、索引"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#10、索引" class="headerlink" title="10、索引"></a>10、索引</h4><p>MongoDB的索引机制与传统SQL的索引基本上是一样的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//创建索引</span></div><div class="line">db.demo.ensureIndex(&#123;<span class="string">'a'</span>:<span class="number">1</span>&#125;);</div><div class="line"></div><div class="line"><span class="comment">//创建子文档索引</span></div><div class="line">db.demo.ensureIndex(&#123;<span class="string">'a.b'</span>:<span class="number">-1</span>&#125;);</div><div class="line"></div><div class="line"><span class="comment">//创建复合索引</span></div><div class="line">db.demo.ensureIndex(&#123;</div><div class="line">   <span class="string">"a"</span>:<span class="number">1</span>,<span class="string">"b"</span>:<span class="number">-1</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//在MongoDB中，1表示升序，-1表示降序</span></div><div class="line"></div><div class="line"><span class="comment">//重新索引，一般是修改索引后重新索引操作</span></div><div class="line">db.demo.reIndex();</div><div class="line"></div><div class="line"><span class="comment">//删除索引</span></div><div class="line">db.demo.dropIndexes();</div></pre></td></tr></table></figure>
<h4 id="11、聚合"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#11、聚合" class="headerlink" title="11、聚合"></a>11、聚合</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">count()</div><div class="line"><span class="comment">//select count(a) from demo where a = 1;</span></div><div class="line">db.demo.count(&#123;<span class="string">"a"</span>:<span class="number">1</span>&#125;);</div><div class="line">distinct()</div><div class="line">db.demo.distinct(<span class="string">"zip-code"</span>,&#123;<span class="attr">a</span>:<span class="number">1</span>&#125;);</div><div class="line">group(key,cond,reduce,initial)</div></pre></td></tr></table></figure>
<p>其中，</p>
<ul>
<li>key ：分组依据</li>
<li>cond： 查询条件</li>
<li>reduce：聚合操作</li>
<li>initial ： 指定聚合计数器的初始对象</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//sql表示</div><div class="line"><span class="keyword">select</span> a,b,<span class="keyword">sum</span>(c) <span class="keyword">from</span> demo <span class="keyword">where</span> a = <span class="number">1</span> <span class="keyword">group</span> <span class="keyword">by</span> a,b;</div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//MongoDB表示</span></div><div class="line">db.demo.gourp(&#123;</div><div class="line">  <span class="string">"key"</span>:&#123;</div><div class="line">     <span class="string">"a"</span>: <span class="literal">true</span>,</div><div class="line">     <span class="string">"b"</span>: <span class="literal">true</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"cond"</span>:&#123;</div><div class="line">     <span class="string">"a"</span>:<span class="number">1</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="12、归纳一下MongoDB中的一些Tips"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#12、归纳一下MongoDB中的一些Tips" class="headerlink" title="12、归纳一下MongoDB中的一些Tips"></a>12、归纳一下MongoDB中的一些Tips</h4><p><strong>1、MongoDB与传统SQL的显著区别</strong></p>
<table>
<thead>
<tr>
<th>SQL</th>
<th>MongoDB</th>
</tr>
</thead>
<tbody>
<tr>
<td>表(Table)</td>
<td>集合(Collection)</td>
</tr>
<tr>
<td>行(row)</td>
<td>文档(document)</td>
</tr>
</tbody>
</table>
<p><strong>2、集合不能以system.开头， 这是因为MongoDB中的系统集合保持的前缀。比如</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db.system.update(<span class="built_in">document</span>);  <span class="comment">//错误</span></div></pre></td></tr></table></figure>
<p><strong>3、 ObjectId类型是_id的默认类型，也可以自己指定其数据类型。MongoDB的初衷是设计成一个分布式的数据库，所以不会自动实现_id的自增。插入文档时，如果没有指定_id的值，则系统自动创建一个ObjectId类型的值，一般在客户端的驱动程序中完成。</strong><br><strong>4、插入文档时，MongoDB会解析BSON数据，BSON数据格式与JSON基本一致，在MongoDB中称为BSON。插入时会检查是否包含_id以及检查文档数据是否超过16MB,其余全部不作检查，从而实现其高效率性。</strong><br><strong>5、MongoDB在插入数据时，不会执行插入数据的代码，而是将BSON数据直接写入，不作任何的数据验证，所以不存在类似于SQL中的注入风险。</strong></p>
<h4 id="说明"><a href="/2016/07/08/玩转MongoDB之基础杂萃/#说明" class="headerlink" title="说明"></a>说明</h4><p>本篇文章也是笔者自己在学习过后总结出来的。也是针对习惯于传统SQL的简友们写的，传统的SQL数据库与NoSQL个人感觉差别还算是挺大的。刚开始接触NoSQL的时候最大的不适应就是在MongoDB中是不需要设计表和表结构的，全是基于JSON的数据操作，所以其逻辑原理都在程序代码中实现，而MongoDB本身只负责分布式的数据存储。</p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    




                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2016/07/17/JSON基础知识总结/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2016/06/05/二十分钟学会Javascript高级知识/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Anderson's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        jieshiluxueyan@163.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/02/">二月 2017<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">一月 2017<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/11/">十一月 2016<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">十月 2016<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/08/">八月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/06/">六月 2016<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/05/">五月 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/04/">四月 2016<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/03/">三月 2016<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/12/">十二月 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/11/">十一月 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/10/">十月 2015<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/09/">九月 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2014/12/">十二月 2014<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/ASP-Net/">ASP.Net<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/Database/">Database<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/categories/Front-end/">Front-end<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/GWT/">GWT<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Gradle/">Gradle<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Hexo/">Hexo<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/Ionic/">Ionic<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/JQuery/">JQuery<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Java/">Java<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/Linux/">Linux<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/REST/">REST<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/Software-Engineering/">Software Engineering<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/categories/Tool/">Tool<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/tool/">tool,<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/作品/">作品<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/杂项/">杂项<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/杂项/安全/">安全<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/游戏/">游戏<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/阅读/">阅读<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/随笔/">随笔<span class="sidebar_archives-count">5</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="标签">
                
                    <i class="material-icons sidebar-material-icons">navigation</i>
                
                标签
            </a>
        </li>
        
    
        <li>
            <a href="/timeline" title="时光">
                
                    <i class="material-icons sidebar-material-icons">fingerprint</i>
                
                时光
            </a>
        </li>
        
    
        <li>
            <a href="/download" title="下载">
                
                    <i class="material-icons sidebar-material-icons">cloud_download</i>
                
                下载
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="关于">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于
            </a>
        </li>
        
    
        <li>
            <a href="/links" title="链接">
                
                    <i class="material-icons sidebar-material-icons">link</i>
                
                链接
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">55</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    您是本站的第<span id="busuanzi_value_site_uv"></span>位访客
   
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;Hummingman Maintain by Anderson
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">            
           
        </div>
    
</footer>


                    <!-- Import File -->
<script src="/js/lazyload.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    <script src="/js/smoothscroll.js"></script>





    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>







<!-- Swiftye -->


<!-- Local Search-->

    <script>
    var searchFunc = function(path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: 'xml',
            success: function( xmlResponse ) {
                // get the contents from search data
                var datas = $( 'entry', xmlResponse ).map(function() {
                    return {
                        title: $( 'title', this ).text(),
                        content: $('content',this).text(),
                        url: $( 'url' , this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function() {
                    var str='<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = '';
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function(data) {
                        var isMatch = true;
                        var content_index = [];
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g,'').toLowerCase();
                        var data_url = data.url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if(data_title !== '' && data_content !== '') {
                            keywords.forEach(function(keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if( index_title < 0 && index_content < 0 ) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += '<li><a href="'+ data_url +'" class="search-result-title" target="_blank">'+ data_title;
                            var content = data.content.trim().replace(/<[^>]+>/g, '');
                            if (first_occur >= 0) {
                                // cut out characters
                                var start = first_occur - 6;
                                var end = first_occur + 6;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 10;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, 'gi');
                                    match_content = match_content.replace(regS, '<em class="search-keyword">'+keyword+'</em>');
                                })
                                str += '<p class="search-result">' + match_content + '...</p>' +'</a>';
                            }
                        }
                    });
                    $resultContent.innerHTML = str;
                });
            }
        });
    }
</script>


    <script>
        var inputArea = document.querySelector('#search');
        var getSearchFile = function() {
            var path = 'search.xml';
            searchFunc(path, 'search', 'local-search-result');
        }

        if(inputArea) {
            inputArea.onfocus = function() {
                getSearchFile();
            }
        }
    </script>


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->


                </main>
            </div>
        </body>
    
</html>
